<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fuel Pump Simulator ‚Ä¢ Gr√©goire Desparain</title>
  <style>
    :root {
      --bg-grad-1: #0f172a;
      --bg-grad-2: #1e293b;
      --card-bg: #1e2537;
      --text-main: #f8fafc;
      --text-dim: #94a3b8;
      --accent: #38bdf8;
      --radius-xl: 1.25rem;
      --mono: "Courier New", monospace;
    }

    * {
      box-sizing: border-box;
      -webkit-font-smoothing: antialiased;
      padding: 0;
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Inter", Roboto, "Segoe UI", sans-serif;
    }

    body {
      background: radial-gradient(circle at 20% 20%, var(--bg-grad-2) 0%, var(--bg-grad-1) 60%);
      color: var(--text-main);
      line-height: 1.5;
      padding: 2rem 1rem 4rem;
      max-width: 900px;
      margin: 0 auto;
      position: relative;
    }

    header {
      margin-bottom: 2.5rem;
      position: relative;
    }

    .top-row {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      row-gap: 1rem;
      align-items: flex-start;
    }

    .left-buttons {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .nav-btn {
      text-decoration: none;
      color: var(--accent);
      font-size: .9rem;
      font-weight: 500;
      background: rgba(56,189,248,.08);
      border: 1px solid rgba(56,189,248,.4);
      border-radius: var(--radius-xl);
      padding: .5rem .75rem;
      line-height: 1.2;
      display: inline-flex;
      align-items: center;
      gap: .5rem;
      box-shadow: 0 20px 40px rgba(56,189,248,.15);
      transition: all .15s linear;
    }

    .nav-btn:hover {
      background: rgba(56,189,248,.15);
      transform: translateY(-1px) scale(1.01);
    }

    .mini-meta {
      text-align: right;
      color: var(--text-dim);
      font-size: .8rem;
      line-height: 1.3;
    }

    .mini-meta .role {
      color: var(--accent);
      font-weight: 500;
      font-size: .8rem;
    }

    h1 {
      color: var(--text-main);
      font-size: clamp(1.6rem, 1vw, 2rem);
      font-weight: 600;
      letter-spacing: -0.04em;
      line-height: 1.2;
      margin: 1.5rem 0 .5rem;
      display: flex;
      align-items: baseline;
      gap: .5rem;
      flex-wrap: wrap;
    }

    .pill {
      font-size: .7rem;
      font-weight: 500;
      background: rgba(148,163,184,.12);
      border: 1px solid rgba(148,163,184,.3);
      color: var(--text-dim);
      padding: .3rem .5rem;
      border-radius: var(--radius-xl);
      line-height: 1.1;
    }

    .subtitle {
      color: var(--text-dim);
      font-size: 1rem;
      max-width: 650px;
      line-height: 1.4;
    }

    section.block {
      background: var(--card-bg);
      border-radius: var(--radius-xl);
      border: 1px solid rgba(148,163,184,.15);
      box-shadow: 0 30px 80px rgba(0,0,0,.6);
      padding: 1.25rem 1.25rem 1rem;
      margin-bottom: 1.25rem;
    }

    .block h2 {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-main);
      margin-bottom: .6rem;
      display: flex;
      align-items: baseline;
      gap: .5rem;
      flex-wrap: wrap;
    }

    .block p {
      font-size: .9rem;
      color: var(--text-dim);
      margin-bottom: .8rem;
      line-height: 1.5;
    }

    ul.details-list {
      list-style: none;
      padding-left: 0;
    }

    ul.details-list li {
      margin-bottom: .5rem;
      display: flex;
      align-items: flex-start;
      gap: .5rem;
      font-size: .9rem;
      color: var(--text-dim);
      line-height: 1.4;
    }

    ul.details-list li .bullet {
      width: .5rem;
      height: .5rem;
      border-radius: 50%;
      background: var(--accent);
      margin-top: .45rem;
      box-shadow: 0 0 10px rgba(56,189,248,.8);
      flex-shrink: 0;
    }

    pre {
      background: rgba(15,23,42,.5);
      color: #e2e8f0;
      border: 1px solid rgba(56,189,248,.3);
      border-radius: var(--radius-xl);
      padding: 1rem;
      overflow-x: auto;
      font-family: var(--mono);
      font-size: .8rem;
      line-height: 1.4;
      margin-bottom: 1rem;
      box-shadow: 0 0 40px rgba(56,189,248,.15);
      white-space: pre;
    }

    code {
      font-family: var(--mono);
    }

    footer {
      text-align: center;
      color: var(--text-dim);
      font-size: .75rem;
      margin-top: 3rem;
      line-height: 1.4;
    }

    footer a {
      color: var(--accent);
      text-decoration: none;
      font-weight: 500;
    }

    @media (max-width: 480px) {
      .top-row {
        flex-direction: column;
        align-items: flex-start;
      }
      .mini-meta {
        text-align: left;
      }
    }
  </style>
</head>
<body>

<header>
  <div class="top-row">
    <div class="left-buttons">
      <a class="nav-btn" href="/" title="Back to portfolio">‚Üê Back to portfolio</a>
      <a class="nav-btn" href="https://github.com/gregdespa/arduino-gas-pump" target="_blank" rel="noopener noreferrer">
        üß© View Repo
      </a>
    </div>

    <div class="mini-meta">
      <div class="role">Role: Embedded Systems / Arduino</div>
      <div>Tech: Keypad, LCD, sensors, real-time loop</div>
      <div>2024‚Äì2025</div>
    </div>
  </div>

  <h1>
    Fuel Pump Simulator
    <span class="pill">Arduino / Embedded Control</span>
  </h1>

  <p class="subtitle">
    An embedded-system simulation of a self-service gas station pump.
    It handles card validation with PIN code, night lockout, nozzle detection,
    real-time fuel dispensing, live pricing, and a final receipt ‚Äî all displayed
    on an LCD screen. The goal is to reproduce the full user journey of paying
    for fuel at an automatic pump.
  </p>
</header>

<section class="block">
  <h2>01. User flow <span class="pill">How a customer uses it</span></h2>
  <ul class="details-list">
    <li>
      <span class="bullet"></span>
      <span><strong>Station open check:</strong> A light sensor is read. If it's ‚Äúnight‚Äù, the LCD loops on ‚ÄúClosed Station‚Äù and the pump is disabled.</span>
    </li>

    <li>
      <span class="bullet"></span>
      <span><strong>Insert card:</strong> A card sensor on pin 12 detects whether a card is inserted. The pump waits until a card is present.</span>
    </li>

    <li>
      <span class="bullet"></span>
      <span><strong>Enter PIN:</strong> The user enters a 4-digit code on a 4x3 keypad. The screen shows the digits but masks previous ones with ‚Äú*‚Äù. After 3 wrong attempts the card is blocked.</span>
    </li>

    <li>
      <span class="bullet"></span>
      <span><strong>Remove card:</strong> For safety, fuel is not dispensed until the card is physically removed from the reader.</span>
    </li>

    <li>
      <span class="bullet"></span>
      <span><strong>Take nozzle:</strong> A digital input on pin 10 simulates ‚Äúnozzle lifted‚Äù. The LCD instructs: ‚ÄúVeuillez prendre le pistolet...‚Äù</span>
    </li>

    <li>
      <span class="bullet"></span>
      <span><strong>Hold trigger:</strong> While the nozzle is held AND the pump button is pressed, fuel flows in bursts. Every second adds +2 L to the tank and updates both liters and total ‚Ç¨.</span>
    </li>

    <li>
      <span class="bullet"></span>
      <span><strong>Hang nozzle / receipt:</strong> When the nozzle is put back, the LCD prints the final liters and the price, then ‚Äú√Ä Bient√¥t !‚Äù.</span>
    </li>
  </ul>
</section>

<section class="block">
  <h2>02. Safety & realism <span class="pill">Why it feels real</span></h2>
  <ul class="details-list">
    <li>
      <span class="bullet"></span>
      <span><strong>Night lockout:</strong> Pump won‚Äôt run if ambient light is below a threshold (station closed).</span>
    </li>
    <li>
      <span class="bullet"></span>
      <span><strong>Anti-fraud PIN:</strong> 4-digit PIN ("7358"). After 3 failed attempts, the card is blocked and the transaction is killed (<code>kill = 1</code>).</span>
    </li>
    <li>
      <span class="bullet"></span>
      <span><strong>‚ÄúRemove card‚Äù rule:</strong> User must pull their card before pumping, like a real pay-at-pump station.</span>
    </li>
    <li>
      <span class="bullet"></span>
      <span><strong>Nozzle logic:</strong> You can't pump without taking the nozzle, and you have to return it to get the final receipt.</span>
    </li>
    <li>
      <span class="bullet"></span>
      <span><strong>Live price calc:</strong> Price is updated while you hold the button, based on <code>P_SP22 = 4.30 ‚Ç¨/L</code> and the volume delivered.</span>
    </li>
  </ul>
</section>

<section class="block">
  <h2>03. Hardware I/O <span class="pill">Electronics</span></h2>
  <ul class="details-list">
    <li>
      <span class="bullet"></span>
      <span><strong>Keypad 4x3</strong> wired on digital pins 22‚Äì28 for PIN entry.</span>
    </li>

    <li>
      <span class="bullet"></span>
      <span><strong>16x2 LCD</strong> display on pins (8, 9, 2, 3, 5, 6) ‚Äî shows instructions, liters, total price.</span>
    </li>

    <li>
      <span class="bullet"></span>
      <span><strong>Light sensor</strong> on analog <code>A1</code> ‚Äî used to detect if the station is ‚Äúopen‚Äù.</span>
    </li>

    <li>
      <span class="bullet"></span>
      <span><strong>Card presence sensor</strong> on pin 12 ‚Äî detects if a card is inserted / removed.</span>
    </li>

    <li>
      <span class="bullet"></span>
      <span><strong>Nozzle sensor</strong> on pin 10 ‚Äî tells if the fuel gun is taken or put back.</span>
    </li>

    <li>
      <span class="bullet"></span>
      <span><strong>Pump trigger button</strong> on pin 4 ‚Äî simulates squeezing the handle to actually pump fuel.</span>
    </li>
  </ul>
</section>

<section class="block">
  <h2>04. Core logic (excerpt) <span class="pill">C / Arduino</span></h2>
  <p>
    Below is a simplified version of the real-time fueling loop.
    Every 1000 ms holding the trigger increases liters and updates the price.
    We also cap the tank at 45 L to avoid overflow.
  </p>

  <pre><code class="language-c">
// price per liter
float P_SP22 = 4.30;

// plein = current tank level
// LPT   = starting level (random 0..60)
// prix  = current price in ‚Ç¨

if (LPT <= 40 && kill != 1) {
    lcd.clear();
    lcd.print("Veuillez prendre");
    lcd.setCursor(0,1);
    lcd.print("le pistolet...");

    // wait until nozzle is taken
    while (digitalRead(10) == 0);

    lcd.clear();
    lcd.print("Appuyez pour demarrer");

    // while nozzle is held
    while (digitalRead(10) == 1) {
        // if trigger pressed
        if (digitalRead(4) == 1) {
            int debut_appui = millis();
            while (digitalRead(4) == 1 && plein < 45) {
                if (millis() - debut_appui >= 1000) {
                    plein += 2; // +2 liters/sec
                    prix = (plein - LPT) * P_SP22;

                    lcd.clear();
                    lcd.setCursor(0,0);
                    lcd.print(plein);
                    lcd.setCursor(10,0);
                    lcd.print(prix);
                    lcd.print("‚Ç¨");

                    debut_appui = millis();
                }
            }
            stop = 1;
        }
    }
}
  </code></pre>

  <p>
    After fueling ends, the system forces the user to put the nozzle back in place,
    then prints a final summary of liters and total cost, and thanks the user.
  </p>
</section>

<section class="block">
  <h2>05. What I learned <span class="pill">Takeaways</span></h2>
  <ul class="details-list">
    <li>
      <span class="bullet"></span>
      <span>Secure UX design for money-related systems (card, PIN, blocking after 3 tries).</span>
    </li>
    <li>
      <span class="bullet"></span>
      <span>State-machine thinking: ‚Äúcard inserted ‚Üí authenticated ‚Üí card removed ‚Üí nozzle lifted ‚Üí trigger held ‚Üí fueling ‚Üí nozzle returned ‚Üí receipt‚Äù.</span>
    </li>
    <li>
      <span class="bullet"></span>
      <span>Real-time control loops in Arduino using <code>millis()</code> instead of <code>delay()</code>, so the interface keeps updating smoothly.</span>
    </li>
    <li>
      <span class="bullet"></span>
      <span>Human-machine interaction: clear instructions on LCD at each step, same tone as a real gas pump.</span>
    </li>
  </ul>
</section>

<footer>
  <p>
    Built by Gr√©goire Desparain ‚Äî IMT Nord Europe (Mines de Douai)<br/>
    <a href="/">‚Üê Back to portfolio</a>
  </p>
</footer>

</body>
</html>
